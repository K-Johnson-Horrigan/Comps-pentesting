#!/bin/bash

# **1. Group creation**
sudo groupadd bar

cd /var/www/html/
# **2. File ownership and permissions**
sudo chown root:bar script.sh  # Assuming 'script.sh' is the name of this file
sudo chmod u+rwx script.sh
sudo chmod g+x script.sh
sudo chmod o-rwx script.sh

sudo chown root:bar files  # Assuming 'files' is a directory or file
sudo chmod ug+rwx files
sudo chmod o-rx files

sudo chown root:bar ./files/login.php 
sudo chmod gu+rwx ./files/login.php
sudo chmod o-rwx ./files/login.php

# **3. User creation**
sudo useradd -m user1 && echo "123456" | sudo passwd user1 --stdin
sudo useradd -m user2 && echo "321654" | sudo passwd user1 --stdin
sudo useradd -m user3 && echo "999999" | sudo passwd user1 --stdin

# **4. Sudoers configuration**  
echo "Defaults env_keep += LD_PRELOAD" | sudo tee -a /etc/sudoers  > /dev/null
echo "user2 ALL=(ALL:ALL) NOPASSWD: /var/www/html/script.sh" | sudo tee -a /etc/sudoers > /dev/null
